# configs/process.yml (UPDATED)
# Main processing configuration with multi-grid support

project_dir: "."

# Multiple hex grids for multi-scale analysis
# Each jittered point will be assigned to ALL grids
hex_grids:
  - name: "fia"
    path: "data/hex/hex_grid.geojson"
    layer: null

  # Scale-threshold set
  - name: "0.5k"
    path: "data/hex/hex_grid_532ac.geojson"
    layer: null

  - name: "1k"
    path: "data/hex/hex_grid_946ac.geojson"
    layer: null

  - name: "2k"
    path: "data/hex/hex_grid_2.1kac.geojson"
    layer: null

  - name: "4k"
    path: "data/hex/hex_grid_3.8kac.geojson"
    layer: null

  - name: "6k"
    path: "data/hex/hex_grid_5.9kac.geojson"
    layer: null

  - name: "8k"
    path: "data/hex/hex_grid_8.5kac.geojson"
    layer: null

  - name: "15k"
    path: "data/hex/hex_grid_15.1kac.geojson"
    layer: null

  - name: "24k"
    path: "data/hex/hex_grid_23.7kac.geojson"
    layer: null

  - name: "53k"
    path: "data/hex/hex_grid_53.3kac.geojson"
    layer: null

  - name: "95k"
    path: "data/hex/hex_grid_94.7kac.geojson"
    layer: null

  - name: "213k"
    path: "data/hex/hex_grid_213kac.geojson"
    layer: null

  - name: "379k"
    path: "data/hex/hex_grid_379kac.geojson"
    layer: null

  - name: "592k"
    path: "data/hex/hex_grid_592kac.geojson"
    layer: null

  - name: "1515k"
    path: "data/hex/hex_grid_1515kac.geojson"
    layer: null

  - name: "2367k"
    path: "data/hex/hex_grid_2367kac.geojson"
    layer: null

  - name: "6059k"
    path: "data/hex/hex_grid_6059kac.geojson"
    layer: null

  - name: "24238k"
    path: "data/hex/hex_grid_24238kac.geojson"
    layer: null

  - name: "54536k"
    path: "data/hex/hex_grid_54536kac.geojson"
    layer: null

  - name: "96952k"
    path: "data/hex/hex_grid_96952kac.geojson"
    layer: null

# Default grid for initial plot assignment (use FIA official or finest)
hex_path: "data/hex/hex_grid.geojson"
hex_layer: null

# Multiple hex grid sizes (for creating new grids)
# Note: FIA official grid already exists, only create custom sizes
hex_sizes:
  - area_acres: 532
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_532ac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 946
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_946ac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 2100
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_2.1kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 3800
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_3.8kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 5900
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_5.9kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 8500
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_8.5kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 15100
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_15.1kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 23700
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_23.7kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 53300
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_53.3kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 94700
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_94.7kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 213000
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_213kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 379000
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_379kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 592000
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_592kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 1515000
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_1515kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 2367000
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_2367kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 6059520
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_6059kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 24238080
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_24238kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 54535680
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_54536kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

  - area_acres: 96952320
    clip_to: "data/hex/hex_grid.geojson"
    out_path: "data/hex/hex_grid_96952kac.geojson"
    exclude_water: "data/hex/Waterbodies_FeaturesToJSON.geojson"
    buffer_miles: 0

# Choose metric: aglb, carbon, mortality, growth, regeneration
metric: "aglb"

# Metric-specific parameters
metric_params:
  carbon_fraction: 0.5
  dbh_sapling: 2.5
  dbh_tree: 5.0

# Updated processing years (annual FIA stable period)
years: [2020, 2021, 2022, 2023, 2024]
level_window: 5

# Monte Carlo settings (used in Stage 5)
mc_reps: 100              # Number of jitter replicates
jitter_radius_m: 1609.34  # ~1 mile

# Jitter constraints
mask:
  use_hex_union: true
  use_state_constraint: true
  state_geo_path: "data/boundaries/states_5070.geojson"
  state_field: "STATEFP"
  max_reroll: 10

# Run ID (auto-generated if null)
run_id: null
